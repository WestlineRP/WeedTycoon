<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weed Farm Clicker</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&family=Roboto:wght@400;700&display=swap');
        body {
            font-family: 'Comic Neue', cursive;
            background: #a8e6cf;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            overflow-y: auto;
            background-image: url('https://www.shutterstock.com/image-photo/vectorized-cartoon-illustration-cannabis-field-260nw-2610556367.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.5);
            pointer-events: none;
        }
        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: auto auto;
            gap: 20px;
        }
        .game-area {
            grid-column: 1 / 4;
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        .shop-area, .upgrades-area, .achievements-area {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }
        .stats-area, .prestige-area {
            grid-column: span 1;
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }
        .full-row {
            grid-column: 1 / 4;
        }
        h1 {
            font-size: 60px;
            color: #2e8b57;
            margin-bottom: 10px;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.2);
        }
        h2 {
            color: #228b22;
            border-bottom: 4px dotted #90ee90;
            padding-bottom: 10px;
            font-size: 32px;
        }
        #clickButton {
            background: url('https://static.vecteezy.com/system/resources/thumbnails/067/115/517/small_2x/weed-or-cannabis-mascot-cartoon-character-logo-template-vector.jpg') no-repeat center center;
            background-size: contain;
            width: 250px;
            height: 250px;
            border: 8px solid #7fff00;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
        }
        #clickButton:hover {
            transform: scale(1.15) rotate(5deg);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }
        #clickButton:active {
            transform: scale(0.95) rotate(-5deg);
        }
        .item-container {
            background: #e0ffe0;
            padding: 20px;
            margin: 15px 0;
            border-radius: 20px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            transition: transform 0.2s;
        }
        .item-container:hover {
            transform: translateY(-5px);
        }
        .item-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }
        .buy-button {
            background: #32cd32;
            color: white;
            border: none;
            padding: 15px 30px;
            cursor: pointer;
            border-radius: 50px;
            font-weight: bold;
            font-size: 18px;
            min-width: 120px;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
        }
        .buy-button:hover {
            background: #228b22;
        }
        .buy-button:active {
            transform: scale(0.95);
        }
        .buy-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        .prestige-button {
            background: #ffd700;
            color: #000;
            border: none;
            padding: 20px;
            cursor: pointer;
            border-radius: 50px;
            width: 100%;
            font-size: 24px;
            font-weight: bold;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        .prestige-button:hover {
            background: #ffec8b;
        }
        .achievement {
            background: #98fb98;
            padding: 20px;
            margin: 10px 0;
            border-radius: 20px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }
        .locked {
            opacity: 0.5;
            filter: grayscale(80%);
        }
        #particle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .particle {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #ff69b4, #ffd700, #32cd32);
            border-radius: 50%;
            opacity: 0.9;
            animation: float 2.5s ease-out forwards;
        }
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg) scale(1); opacity: 0.9; }
            100% { transform: translateY(-300px) rotate(360deg) scale(0); opacity: 0; }
        }
        @media (max-width: 1200px) {
            .container { grid-template-columns: 1fr 1fr; }
            .game-area, .full-row { grid-column: 1 / 3; }
        }
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
            #clickButton { width: 200px; height: 200px; }
            h1 { font-size: 48px; }
        }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div id="particle-container"></div>
    <div class="container">
        <div class="game-area">
            <h1>Weed Farm Clicker</h1>
            <p id="hitsDisplay">Buds: 0</p>
            <p id="hpsDisplay">Buds per second: 0</p>
            <button id="clickButton" title="Harvest Bud!"></button>
        </div>
       
        <div class="shop-area">
            <h2>Farm Shop</h2>
            <div id="shopItems"></div>
        </div>
       
        <div class="upgrades-area">
            <h2>Upgrades</h2>
            <div id="upgrades"></div>
        </div>
       
        <div class="achievements-area">
            <h2>Achievements</h2>
            <div id="achievements"></div>
        </div>
       
        <div class="stats-area full-row">
            <h2>Stats</h2>
            <p id="totalHits">Total Buds Harvested: 0</p>
            <p id="totalClicks">Total Clicks: 0</p>
            <p id="prestigePoints">Prestige Points: 0</p>
            <p id="prestigeBonus">Prestige Bonus: +0%</p>
        </div>
       
        <div class="prestige-area">
            <h2>Prestige</h2>
            <p>Reset your farm for super bonuses!</p>
            <p id="prestigeGain">Potential Gain: 0 points</p>
            <button id="prestigeButton" class="prestige-button" disabled>Prestige Now!</button>
        </div>
    </div>

    <script>
        // (Same game logic as the previous fixed version â€“ unchanged for stability)
        let buds = 0;
        let budsPerSecond = 0;
        let clickValue = 1;
        let totalBuds = 0;
        let totalClicks = 0;
        let prestigePoints = 0;
        let prestigeMultiplier = 1;

        const shopItems = [
            { name: 'Seed Planter', baseCost: 15, cost: 15, bps: 0.1, owned: 0, desc: 'Plants seeds automatically.', button: null, text: null },
            { name: 'Watering System', baseCost: 100, cost: 100, bps: 1, owned: 0, desc: 'Keeps plants hydrated.', button: null, text: null },
            { name: 'Grow Lights', baseCost: 500, cost: 500, bps: 5, owned: 0, desc: 'Accelerates growth.', button: null, text: null },
            { name: 'Greenhouse', baseCost: 3000, cost: 3000, bps: 30, owned: 0, desc: 'Controlled environment.', button: null, text: null },
            { name: 'Hydroponic Setup', baseCost: 15000, cost: 15000, bps: 150, owned: 0, desc: 'Soil-less farming.', button: null, text: null },
            { name: 'Outdoor Field', baseCost: 100000, cost: 100000, bps: 1000, owned: 0, desc: 'Massive scale planting.', button: null, text: null },
            { name: 'Automated Harvester', baseCost: 500000, cost: 500000, bps: 5000, owned: 0, desc: 'Mechanical harvesting.', button: null, text: null },
            { name: 'Cannabis Empire', baseCost: 2000000, cost: 2000000, bps: 20000, owned: 0, desc: 'Global farm network.', button: null, text: null }
        ];

        const upgrades = [
            { name: 'Better Seeds', cost: 200, effect: () => clickValue *= 2, desc: 'Doubles harvest per click.', purchased: false, container: null },
            { name: 'Fertilizer', cost: 1000, effect: () => budsPerSecond *= 1.5, desc: '50% boost to production.', purchased: false, container: null },
            { name: 'Premium Strain', cost: 5000, effect: () => clickValue *= 3, desc: 'Triples click harvest.', purchased: false, container: null },
            { name: 'Advanced Hydro', cost: 25000, effect: () => { shopItems.forEach(i => i.bps *= 1.2); recalculateBPS(); }, desc: '20% boost to all producers.', purchased: false, container: null },
            { name: 'Trimming Bots', cost: 100000, effect: () => clickValue += budsPerSecond * 0.2, desc: 'Clicks gain 20% of BPS.', purchased: false, container: null },
            { name: 'Genetic Engineering', cost: 500000, effect: () => budsPerSecond *= 2, desc: 'Doubles all production.', purchased: false, container: null }
        ];

        const achievements = [
            { name: 'First Harvest', desc: 'Harvest your first bud.', unlocked: false, condition: () => totalClicks >= 1 },
            { name: 'Bud Beginner', desc: 'Reach 420 buds.', unlocked: false, condition: () => totalBuds >= 420 },
            { name: 'Planter Pro', desc: 'Own 20 Seed Planters.', unlocked: false, condition: () => shopItems[0].owned >= 20 },
            { name: 'Green Thumb', desc: 'Reach 10,000 buds.', unlocked: false, condition: () => totalBuds >= 10000 },
            { name: 'Farm Tycoon', desc: 'Own a Cannabis Empire.', unlocked: false, condition: () => shopItems[7].owned >= 1 },
            { name: 'Prestigious Farmer', desc: 'Prestige once.', unlocked: false, condition: () => prestigePoints >= 1 },
            { name: 'Click Master', desc: 'Click 1000 times.', unlocked: false, condition: () => totalClicks >= 1000 },
            { name: 'Idle Farmer', desc: 'Reach 420 BPS.', unlocked: false, condition: () => budsPerSecond >= 420 }
        ];

        const budsDisplay = document.getElementById('hitsDisplay');
        const bpsDisplay = document.getElementById('hpsDisplay');
        const clickButton = document.getElementById('clickButton');
        const shopDiv = document.getElementById('shopItems');
        const upgradesDiv = document.getElementById('upgrades');
        const achDiv = document.getElementById('achievements');
        const totalBudsP = document.getElementById('totalHits');
        const totalClicksP = document.getElementById('totalClicks');
        const prestigePointsP = document.getElementById('prestigePoints');
        const prestigeBonusP = document.getElementById('prestigeBonus');
        const prestigeGainP = document.getElementById('prestigeGain');
        const prestigeBtn = document.getElementById('prestigeButton');

        function loadGame() {
            const saved = localStorage.getItem('weedFarmClickerSave');
            if (saved) {
                const data = JSON.parse(saved);
                buds = data.buds || 0;
                budsPerSecond = data.bps || 0;
                clickValue = data.clickValue || 1;
                totalBuds = data.totalBuds || 0;
                totalClicks = data.totalClicks || 0;
                prestigePoints = data.prestigePoints || 0;
                prestigeMultiplier = 1 + prestigePoints * 0.1;

                shopItems.forEach((item, i) => {
                    if (data.shop && data.shop[i]) {
                        item.owned = data.shop[i].owned;
                        item.cost = data.shop[i].cost;
                    }
                });
                upgrades.forEach((u, i) => u.purchased = data.upgrades ? data.upgrades[i] : false);
                achievements.forEach((a, i) => a.unlocked = data.achievements ? data.achievements[i] : false);
                recalculateBPS();
            }
        }

        function saveGame() {
            const data = {
                buds, bps: budsPerSecond, clickValue, totalBuds, totalClicks, prestigePoints,
                shop: shopItems.map(i => ({owned: i.owned, cost: i.cost})),
                upgrades: upgrades.map(u => u.purchased),
                achievements: achievements.map(a => a.unlocked)
            };
            localStorage.setItem('weedFarmClickerSave', JSON.stringify(data));
        }

        function recalculateBPS() {
            budsPerSecond = shopItems.reduce((sum, item) => sum + item.bps * item.owned, 0) * prestigeMultiplier;
        }

        function updateDisplays() {
            budsDisplay.textContent = `Buds: ${Math.floor(buds)}`;
            bpsDisplay.textContent = `Buds per second: ${budsPerSecond.toFixed(1)}`;
            totalBudsP.textContent = `Total Buds Harvested: ${Math.floor(totalBuds)}`;
            totalClicksP.textContent = `Total Clicks: ${totalClicks}`;
            prestigePointsP.textContent = `Prestige Points: ${prestigePoints}`;
            prestigeBonusP.textContent = `Prestige Bonus: +${((prestigeMultiplier - 1) * 100).toFixed(0)}%`;

            const gain = Math.floor(Math.sqrt(totalBuds / 5000));
            prestigeGainP.textContent = `Potential Gain: ${gain} points`;
            prestigeBtn.disabled = gain <= 0;

            shopItems.forEach(item => {
                if (item.button && item.text) {
                    item.button.disabled = buds < item.cost;
                    item.text.innerHTML = `<strong>${item.name} (${item.owned})</strong><br>${item.desc}<br>Cost: ${Math.floor(item.cost)} buds | +${item.bps.toFixed(1)} BPS`;
                }
            });

            upgrades.forEach(u => {
                if (u.container) {
                    u.container.style.display = u.purchased ? 'none' : 'block';
                    if (!u.purchased && u.container.querySelector('.buy-button')) {
                        u.container.querySelector('.buy-button').disabled = buds < u.cost;
                    }
                }
            });

            checkAchievements();
            renderAchievements();
        }

        function createShop() {
            shopDiv.innerHTML = '';
            shopItems.forEach((item, idx) => {
                const container = document.createElement('div');
                container.className = 'item-container';
                container.innerHTML = `
                    <div class="item-content">
                        <div class="item-text"></div>
                        <button class="buy-button">Buy</button>
                    </div>
                `;
                item.text = container.querySelector('.item-text');
                item.button = container.querySelector('.buy-button');
                item.button.addEventListener('click', () => buyItem(idx));
                shopDiv.appendChild(container);
            });
        }

        function createUpgrades() {
            upgradesDiv.innerHTML = '';
            upgrades.forEach((u, idx) => {
                const container = document.createElement('div');
                container.className = 'item-container';
                container.innerHTML = `
                    <div class="item-content">
                        <div class="item-text">
                            <strong>${u.name}</strong><br>
                            ${u.desc}<br>
                            Cost: ${u.cost} buds
                        </div>
                        <button class="buy-button">Buy</button>
                    </div>
                `;
                const button = container.querySelector('.buy-button');
                button.addEventListener('click', () => buyUpgrade(idx));
                u.container = container;
                upgradesDiv.appendChild(container);
            });
        }

        function buyItem(idx) {
            const item = shopItems[idx];
            if (buds >= item.cost) {
                buds -= item.cost;
                item.owned++;
                item.cost = Math.floor(item.cost * 1.15);
                recalculateBPS();
                updateDisplays();
                saveGame();
            }
        }

        function buyUpgrade(idx) {
            const u = upgrades[idx];
            if (buds >= u.cost && !u.purchased) {
                buds -= u.cost;
                u.effect();
                u.purchased = true;
                recalculateBPS();
                updateDisplays();
                saveGame();
            }
        }

        function renderAchievements() {
            achDiv.innerHTML = '';
            achievements.forEach(a => {
                const el = document.createElement('div');
                el.className = `achievement ${a.unlocked ? '' : 'locked'}`;
                el.innerHTML = `<strong>${a.name}</strong><br>${a.desc}`;
                achDiv.appendChild(el);
            });
        }

        function checkAchievements() {
            achievements.forEach(a => {
                if (!a.unlocked && a.condition()) {
                    a.unlocked = true;
                }
            });
        }

        clickButton.addEventListener('click', () => {
            const gain = clickValue * prestigeMultiplier;
            buds += gain;
            totalBuds += gain;
            totalClicks++;
            createParticles();
            updateDisplays();
            saveGame();
        });

        prestigeBtn.addEventListener('click', () => {
            const gain = Math.floor(Math.sqrt(totalBuds / 5000));
            if (gain > 0 && confirm('Prestige? This will reset everything for permanent bonuses!')) {
                prestigePoints += gain;
                prestigeMultiplier = 1 + prestigePoints * 0.1;

                buds = 0;
                totalBuds = 0;
                totalClicks = 0;
                budsPerSecond = 0;
                clickValue = 1;

                shopItems.forEach(i => {
                    i.owned = 0;
                    i.cost = i.baseCost;
                });
                upgrades.forEach(u => u.purchased = false);

                recalculateBPS();
                updateDisplays();
                saveGame();
            }
        });

        function createParticles() {
            const container = document.getElementById('particle-container');
            const rect = clickButton.getBoundingClientRect();
            for (let i = 0; i < 12; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = `${rect.left + rect.width / 2 + (Math.random() * 80 - 40)}px`;
                p.style.top = `${rect.top + rect.height / 2}px`;
                container.appendChild(p);
                setTimeout(() => p.remove(), 2500);
            }
        }

        setInterval(() => {
            if (budsPerSecond > 0) {
                const gain = budsPerSecond / 10;
                buds += gain;
                totalBuds += gain;
                updateDisplays();
            }
        }, 100);

        setInterval(saveGame, 30000);

        createShop();
        createUpgrades();
        loadGame();
        updateDisplays();
        renderAchievements();
    </script>
</body>
</html>
